<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DEXTER Â· Sila Divine Attacker</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="/static/style.css" rel="stylesheet">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <!-- Divine Header -->
        <div class="divine-header">
            <div class="logo">
                <i class="fas fa-sync-alt wheel-icon"></i>
                <div class="title">attacker<span>â¸¸DEXTER</span></div>
            </div>
            <div class="badge-creator" id="userBadge">
                <i class="fas fa-crown"></i> <span id="usernameDisplay">LOADING...</span>
                <i class="fas fa-shield-alt" style="margin-left: 0.5rem;"></i>
            </div>
        </div>

        <!-- Wheel Status Panel -->
        <div class="wheel-panel">
            <div class="rotation-box">
                <i class="fas fa-compact-disc rotation-icon"></i>
                <span class="adapt-text">ADAPTASI LEVEL <span id="adaptLevel">01</span></span>
                <span class="adapt-level" id="wheelCount"><i class="fas fa-rotate"></i> 0/âˆž</span>
            </div>
            <div style="display:flex; gap:1.5rem;">
                <span style="color:#b1bac4;"><i class="fas fa-bolt"></i> IMMUNITY: <span id="immunityStatus">BASIC</span></span>
                <span class="creator-badge" id="creatorBadge" style="display:none;">
                    <i class="fas fa-skull"></i> CREATOR MODE
                </span>
            </div>
        </div>

        <!-- Main Grid: Attack Panel + Dexter AI -->
        <div class="grid-2col">
            <!-- Attack Panel -->
            <div class="attack-panel">
                <h3><i class="fas fa-bullseye"></i> ATTACK VECTOR Â· ADAPTIVE</h3>
                <div class="attack-grid" id="attackGrid"></div>
                <div class="target-input">
                    <input type="text" id="targetInput" placeholder="target IP/URL/phone ...">
                    <button onclick="launchAttack()" id="launchBtn">
                        <i class="fas fa-bolt"></i> EXECUTE
                    </button>
                </div>
            </div>

            <!-- Dexter AI - REAL AI CHAT -->
            <div class="ai-section">
                <div class="ai-header">
                    <div class="ai-avatar">
                        <i class="fas fa-microchip"></i>
                    </div>
                    <div>
                        <div class="ai-name">DEXTER ai</div>
                        <div class="ai-sub"><span id="aiStatus">â—ˆ wheel synchronizing</span></div>
                    </div>
                    <span class="ai-core-badge">SILA CORE</span>
                </div>
                
                <!-- AI Chat Messages -->
                <div class="ai-chat" id="aiChatBox">
                    <div class="ai-message system">
                        <i class="fas fa-robot"></i>
                        <div class="message-content">
                            <span class="sender">Dexter AI:</span>
                            Wheel berputar. Gw siap adaptasi. Tanya apapun tentang attack, security, atau target.
                        </div>
                    </div>
                </div>
                
                <!-- AI Input -->
                <div class="ai-input-group">
                    <input type="text" class="ai-input" id="aiPrompt" 
                           placeholder="Tanya Dexter AI tentang attack method, vulnerability, atau strategi...">
                    <button class="ai-send" onclick="sendAIPrompt()">
                        <i class="fas fa-paper-plane"></i>
                    </button>
                </div>
                
                <!-- AI Quick Actions -->
                <div class="ai-quick-actions">
                    <span onclick="quickAIAction('analisis celah keamanan website')">
                        <i class="fas fa-shield"></i> Analisis target
                    </span>
                    <span onclick="quickAIAction('cara bypass firewall')">
                        <i class="fas fa-fire"></i> Bypass FW
                    </span>
                    <span onclick="quickAIAction('buatkan payload reverse shell')">
                        <i class="fas fa-code"></i> Generate payload
                    </span>
                </div>
            </div>
        </div>

        <!-- Attack Output Terminal -->
        <div class="terminal" id="outputTerminal">
            <div class="terminal-header">
                <i class="fas fa-terminal"></i>
                <span>ATTACK LOG Â· ADAPTATION TRACKER</span>
                <span class="terminal-status">ðŸŸ¢ READY</span>
            </div>
            <div class="terminal-body" id="terminalBody">
                [â¸¸] Mahoraga adaptation system initialized.<br>
                [â¸¸] Input username untuk memulai wheel.
            </div>
        </div>
    </div>

    <script src="/static/script.js"></script>
    <script>
        // Get username from URL or prompt
        let username = "{{ username }}";
        if (!username || username === "") {
            username = prompt("[ Cursed Mahoraga ] Aktifkan username lu, Shikigami terkuat butuh identitas:", "DEXTER");
            if (!username) username = "USER";
            window.location.href = `/?user=${username}`;
        }
        
        document.getElementById('usernameDisplay').innerText = username;
        
        // Initialize user with backend
        fetch('/api/init', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({username: username})
        })
        .then(res => res.json())
        .then(data => {
            document.getElementById('adaptLevel').innerText = data.level.toString().padStart(2, '0');
            document.getElementById('wheelCount').innerHTML = `<i class="fas fa-rotate"></i> ${data.wheel}/âˆž`;
            
            if (data.is_creator) {
                document.getElementById('creatorBadge').style.display = 'inline-block';
                document.getElementById('aiStatus').innerHTML = 'â—ˆ divine access Â· absolute';
            }
            
            // Load attack grid based on level
            loadAttackGrid(data.level);
        });
        
        function loadAttackGrid(level) {
            const grid = document.getElementById('attackGrid');
            const attacks = [
                {name: 'DDOS', icon: 'fa-network-wired', desc: 'HTTP/S flood', level: 1},
                {name: 'OTP SPAM', icon: 'fa-message', desc: 'WhatsApp/SMS bomb', level: 1},
                {name: 'PORT SCAN', icon: 'fa-search', desc: 'Service discovery', level: 2},
                {name: 'BRUTEFORCE', icon: 'fa-lock', desc: 'SSH/FTP/WordPress', level: 2},
                {name: 'SQL INJECT', icon: 'fa-database', desc: 'SQLi automation', level: 3},
                {name: 'XSS', icon: 'fa-code', desc: 'Payload injection', level: 3}
            ];
            
            grid.innerHTML = attacks.map(attack => `
                <div class="attack-card ${level >= attack.level ? '' : 'locked'}" 
                     onclick="selectAttack('${attack.name}')">
                    <i class="fas ${attack.icon} attack-icon"></i>
                    <div class="attack-title">
                        ${attack.name}
                        ${level < attack.level ? '<span class="attack-badge locked">ðŸ”’ Lv.'+attack.level+'</span>' : ''}
                    </div>
                    <div class="attack-desc">${attack.desc}</div>
                </div>
            `).join('');
        }
        
        let selectedAttack = 'DDOS';
        function selectAttack(attack) {
            selectedAttack = attack;
            document.getElementById('launchBtn').innerHTML = `<i class="fas fa-bolt"></i> ${attack}`;
        }
        
        function launchAttack() {
            const target = document.getElementById('targetInput').value;
            if (!target) {
                alert('Isi target, Master.');
                return;
            }
            
            let endpoint = '';
            if (selectedAttack === 'DDOS') endpoint = '/api/attack/ddos';
            else if (selectedAttack === 'OTP SPAM') endpoint = '/api/attack/otp';
            else if (selectedAttack === 'PORT SCAN') endpoint = '/api/attack/scan';
            else {
                document.getElementById('terminalBody').innerHTML = `[â¸¸] ${selectedAttack} membutuhkan adaptasi level lebih tinggi. ðŸŒ€`;
                return;
            }
            
            fetch(endpoint, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    username: username,
                    target: target,
                    phone: target
                })
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById('terminalBody').innerHTML = `[${new Date().toLocaleTimeString()}] [â¸¸] ${data.message || 'Attack launched'}<br>[â¸¸] Target: ${target}<br>[â¸¸] Wheel berputar lebih kuat. ðŸŒ€ðŸŒ€`;
            });
        }
        
        function sendAIPrompt() {
            const prompt = document.getElementById('aiPrompt').value;
            if (!prompt) return;
            
            // Add user message to chat
            const chatBox = document.getElementById('aiChatBox');
            chatBox.innerHTML += `
                <div class="ai-message user">
                    <i class="fas fa-user"></i>
                    <div class="message-content">
                        <span class="sender">${username}:</span>
                        ${prompt}
                    </div>
                </div>
            `;
            
            // Show loading
            chatBox.innerHTML += `
                <div class="ai-message system" id="loadingMsg">
                    <i class="fas fa-spinner fa-pulse"></i>
                    <div class="message-content">
                        Wheel berputar... menganalisis.
                    </div>
                </div>
            `;
            
            fetch('/api/ai/chat', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({username: username, prompt: prompt})
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById('loadingMsg')?.remove();
                chatBox.innerHTML += `
                    <div class="ai-message system">
                        <i class="fas fa-robot"></i>
                        <div class="message-content">
                            <span class="sender">Dexter AI:</span>
                            ${data.response.replace(/\n/g, '<br>')}
                        </div>
                    </div>
                `;
                chatBox.scrollTop = chatBox.scrollHeight;
            });
            
            document.getElementById('aiPrompt').value = '';
        }
        
        function quickAIAction(query) {
            document.getElementById('aiPrompt').value = query;
            sendAIPrompt();
        }
    </script>
</body>
                        </html>
